<html>

    <head>
        <script type="text/javascript" src="../modules/ServiceDock_SPIKE.js"></script>
        <script type="text/javascript" src="../modules/ServiceDock_SystemLink.js"></script>
    </head>
    <body style="background-image: url('../modules/views/CEEOInnovationsbackground.png');">
        <h1 style="left: 500px; position: absolute">automatic Service initalization</h1>
        <div id="servicedock" style="float:left;">
            <service-systemlink id = "service_systemlink"></service-systemlink>
        </div>
        <div id="changeMessage">
            <div id="currentMessage"> Current "message" tag value: </div>
            <input type="text" id="text" value="Hello World!"></textarea>
            <div>
                <input type="button" id="display" value="change">
            </div>
        </div>
    </body>
    <script>
        var SLService = document.getElementById("service_systemlink");
        SLService.setAttribute("apikey", "daciN5xlHb-J_eABvDQPRIYt4jrKmbUbCl-Zc2vta7");
        SLService.init();
        
        var mySL = SLService.getService();

        var message;

        var currentMessage;

        var currentMessageDIV = document.getElementById("currentMessage");
        var textArea = document.getElementById("text");
        var changeButton = document.getElementById("display");

        mySL.executeAfterInit(async function () {

            currentMessage = await mySL.getTagValue("message");

            /* update and get "LEGOSpeed" and "message" tag values every 100 miliseconds */
            var SLInterval = setInterval(async function () {

                /* get message" tag values */
                currentMessage = tagsInfo.message.value;

                currentMessageDIV.innerHTML = "Current 'message' tag value: " + currentMessage;

            }, 100);

            changeButton.addEventListener("click", function () {

                message = textArea.value;
                console.log("message", message);
                mySL.setTagValue("message", message);
            })

        });
    </script>
    <style>
        #display {
            font-size: 20px;
        }

        #text {
            height: 125px;
            width: 200px;
            font-size: 20px;
        }

        #changeMessage {
            font-size: 20px;
            position: absolute;
            
            left: 10%;
            top: 25%;

            background-color: rgb(214, 230, 71);
            width: 400px;
            height: 200px;
            border:solid;
        }
    </style>
</html>