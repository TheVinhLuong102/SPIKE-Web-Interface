<html>

    <head>
        <script type="text/javascript" src="./modules/ServiceDock_SPIKE.js"></script>
        <script type="text/javascript" src="./modules/ServiceDock_SystemLink.js"></script>
        <script src="./modules/libraries/jquery_351.js" type="text/javascript"></script>
        <script src="./modules/libraries/hoverscript_jquery.js" type="text/javascript"></script>
    </head>

    <body style="background-image: url('/examples/modules/views/CEEOInnovationsbackground.png');">
        <div id="servicedock" style="float:left;">
            <service-spike id="service_spike"></service-spike>
            <service-systemlink id="service_systemlink" ></service-systemlink>
        </div>
        <div id = "output"></div>
        <div id = "SPIKEbox">
            <select id="SPIKEselectTest">
                <option id="motorOPTION"> motor functions </option>
                <option id="motorPairOPTION"> motorPair functions </option>
                <option id="motionOPTION"> motion sensor functions </option>
                <option id="forceOPTION"> force sensor functions </option>
                <option id="speakerOPTION"> Primehub.speaker functions </option>
                <option id="buttonOPTION"> Primehub.button functions </option>
                <option id="miscOPTION"> miscellaneous functions </option>
            </select>
            <input type="button" id="SPIKE_test_select" value="display test cases for this function">
            <div id="SPIKEtests">
                <!-- motor functions -->
                <input type="button" id="motorrelpos" class="SPIKEtestCase motor" value="motor go to rel pos ( with stall detection )">
                <input type="button" id="motorrelpos1" class="SPIKEtestCase motor" value="motor go to rel pos ( NO stall detection )">
                <input type="button" id="degreesCounted" class="SPIKEtestCase motor" value="motor get degrees counted">
                <input type="button" id="motorPosition" class="SPIKEtestCase motor" value="motor get position">
                <input type="button" id="getPower" class="SPIKEtestCase motor" value="motor get power">
                <input type="button" id="getSpeed" class="SPIKEtestCase motor" value="motor get speed">

                <!-- motor pair functions -->
                <input type="button" id="motorPairMove" class="SPIKEtestCase motorPair" value="motorPair move(100, 'cm', 0, 100)">
                <input type="button" id="motorPairMoveLeft" class="SPIKEtestCase motorPair" value="motorPair move left (steering: -100) ">
                <input type="button" id="motorPairMoveRight" class="SPIKEtestCase motorPair" value="motorPair move right (steering: 100)">
                <input type="button" id="motorPairMoveLeftSlightly" class="SPIKEtestCase motorPair" value="motorPair move left (steering: -50) ">
                <input type="button" id="motorPairMoveRightSlightly" class="SPIKEtestCase motorPair" value="motorPair move right (steering: 50)">
                <input type="button" id="motorPairStart" class="SPIKEtestCase motorPair" value="motorPair start(0, 100)">
                <input type="button" id="motorPairStartLeft" class="SPIKEtestCase motorPair" value="motorPair start left">
                <input type="button" id="motorPairStartRight" class="SPIKEtestCase motorPair" value="motorPair start right">
                <input type="button" id="motorPairStop" class="SPIKEtestCase motorPair" value="motorPair stop()">
                <!-- motion sensor functions-->
                <input type="button" id="waitForNewGesture" class="SPIKEtestCase motion" value="wait_for_new_gesture test">
                <input type="button" id="wasGesture" class="SPIKEtestCase motion" value="was_gesture test">
                <input type="button" id="waitForNewOri" class="SPIKEtestCase motion" value="wait_for_new_orientation test">
                <input type="button" id="getAngles" class="SPIKEtestCase motion" value = "get angles test">
                <input type="button" id="resetYaw" class="SPIKEtestCase motion" value="reset yaw angle() test">
                <input type="button" id="resetYawSource" class="SPIKEtestCase motion" value="reset yaw angle() source code test">
                <input type="button" id="getGesture" class="SPIKEtestCase motion" value="getGesture() test">
                <input type="button" id="getOrientation" class="SPIKEtestCase motion" value="getOrientation() test">
                
                <!-- Force sensor functions-->
                <input type="button" id="getForceNewton" class="SPIKEtestCase force" value="get_force_newton() test">
                <input type="button" id="getForcePercentage" class="SPIKEtestCase force" value="get_force_percentage() test">
                <input type="button" id="forceSensorIsPressed" class="SPIKEtestCase force" value="is_pressed() test">
                <input type="button" id="forceSensorWaitUntilPress" class="SPIKEtestCase force" value="wait_until_pressed() test">
                <input type="button" id="forceSensorWaitUntilRelease" class="SPIKEtestCase force" value="wait_until_released() test">
                
                <!-- speaker functions-->
                <input type="button" id="beep" class="SPIKEtestCase speaker" value="beep(note,seconds) test">
                <input type="button" id="startBeep" class="SPIKEtestCase speaker" value="startBeep(note) test">
                <input type="button" id="stopBeep" class="SPIKEtestCase speaker" value="speaker.stop() test">
                
                <!-- button functions-->
                <input type="button" id="buttonWaitPress" class="SPIKEtestCase button" value="left and right button.wait_until_pressed(callback)">
                <input type="button" id="buttonWaitRelease" class="SPIKEtestCase button" value="left and right button.wait_until_released(callback)">
                <input type="button" id="buttonWasPress" class="SPIKEtestCase button" value="left and right button.was_pressed()">
                <input type="button" id="buttonIsPress" class="SPIKEtestCase button" value="left and right button.is_pressed()">
                
                <!-- SPIKE Library functions-->
                <input type="button" id="setHubOri" class="SPIKEtestCase misc" value="setHubOrientation()">
                <input type="button" id="testUJSONRPC" class="SPIKEtestCase misc" value="test UJSONRPC.displayText()">
                <input type="button" id="testNewKeyword" class="SPIKEtestCase misc" value="new Motor() vs Motor()">
                <input type="button" id="testNewKeyword1" class="SPIKEtestCase misc" value="Motor() vs Motor() declared without 'new' keyword">
                <input type="button" id="getMotorPorts" class="SPIKEtestCase misc" value="get motorports">
            
                <div id="chart"></div>
            </div>
        </div>

        <div id="SLbox">
            <div>
                <select id="SLselectTest">
                    <option id="getTagsInfoOPTION">getTagsInfo</option>
                    <option id="createNewTagOPTION"> createNewTag </option>
                    <option id="deleteTagOPTION"> deleteTag </option>
                    <option id="setTagValueOPTION"> setTagValue </option>
                </select>
                <input type = "button" id = "SL_test_select" value = "display test cases for this function">
            </div>
            <div id = "SLtests">

                <!--      getTagsInfo CASES      -->
                <input type="button" id="getTagsInfo"  class = "SLtestCase getTagsInfo" value="getTagsInfo"> <!-- regular -->
                
                <!-- (when there are no tags)-->
                <input type="button" id="getTagsInfo1" class = "SLtestCase getTagsInfo" value="getTagsInfo when there are no tags">
                
                <!-- createNewTag CASES-->
                <input type="button" id="createNewTag" class = "SLtestCase createNewTag" value="create new tag ('newTag')">
                
                <!--deleteTag CASES -->
                <!-- (when tag to delete exists -->
                <input type="button" id="deleteTag"    class = "SLtestCase deleteTag" value="delete tag ('newTag')">
                
                <!-- (when tag to delete doesn't exist)-->
                <input type="button" id="deleteTag1" class="SLtestCase deleteTag" value= "delete tag ('newTag') when it doesnt exist">

                <!-- (when tag to delete doesn't exist)-->
                <input type="button" id="deleteTag2" class="SLtestCase deleteTag" value="jsut delete tag ('newTag')">
                
                <!-- setTagValue CASES -->
                <!-- setTagValue without callback-->
                <input type="button" id="setTagValue" class="SLtestCase setTagValue" value="create 'newTag' with value 4 and change it to 5">

            </div>
            
        </div>
    </body>
    <script>
        var mySPIKE = document.getElementById("service_spike").getService();
        var hub = new mySPIKE.PrimeHub();
        var mySL = document.getElementById("service_systemlink").getService();
        var output = document.getElementById("output");

        //////////////////////////////////////////
        //                                      //
        //             SPIKE Testing            //
        //                                      //
        //////////////////////////////////////////
        
        //                                      //
        //              Motor Tests             //
        //                                      //

        /* go to rel pos stall detection */
        var testMotorRelPos = document.getElementById("motorrelpos");
        testMotorRelPos.addEventListener("click", async function () {
            console.log("###### BEGINNING UNIT TEST ON motor.run_to_position(100) #######");
            console.log("Test: motor connected to port A will move to a certain position.\n" +
            "Check stall detection: Hold the motor. Because stall detect is on, the motor will stop after it being unable to move for some time" + "\n" +
            "Check stall detection response: (example response that detected stall: {'i':4973,'r':2})" + "if not detect stall: {'i':2117,'r':0}");
            var motor = new mySPIKE.Motor("A");
            motor.set_default_speed(50);

            motor.set_stall_detection(true);
            
            motor.run_to_position(180);

            console.log("default speed", motor.get_default_speed());

            console.log("###### ENDING UNIT TEST ON motor.run_to_position(100) #######");

        })

        /* go to rel pos without stall detection */
        var testMotorRelPos1 = document.getElementById("motorrelpos1");
        testMotorRelPos1.addEventListener("click", async function () {

            var motor = new mySPIKE.Motor("A");
            motor.set_default_speed(50);
            
            motor.set_stall_detection(false);
            
            motor.run_to_position(180);

            console.log(motor.get_default_speed());

        })

        //                                      //
        //           MotorPair Tests            //
        //                                      //

        var testMotorPairStop = document.getElementById("motorPairStop");
        testMotorPairStop.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST ON motorPair.stop() #######");
            console.log("Test: stop the motorPair of motors connected to A and B");

            var motorPair = new mySPIKE.MotorPair("A","B");

            motorPair.stop();

            console.log("###### ENDING UNIT TEST ON motorPair.stop() #######");
        })

        var testMotorPairMove = document.getElementById("motorPairMove");
        testMotorPairMove.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST ON motorPair.move(100, 'cm', 0, 100) #######");
            console.log("Test: moving the driving base 100 cm with 0 steering on speed of 100");

            var motorPair = new mySPIKE.MotorPair("A", "B");

            motorPair.move(100, "cm", 0, 100);

            console.log("Expected result: base moving forward without turning and stopping at 100 cm");

            console.log("###### ENDING UNIT TEST ON motorPair.move() #######");
        })

        var testMotorPairStart = document.getElementById("motorPairStart");
        testMotorPairStart.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST ON motorPair.start() #######");
            console.log(" Test: moving the drving base with 0 steering on speed of 100");

            var motorPair = new mySPIKE.MotorPair("A", "B");

            motorPair.start(0, 100);

            console.log("Expected result: base moving forward without turning");

            console.log("###### ENDING UNIT TEST ON motorPair.start() #######");
        })

        var testMotorPairMoveLeft = document.getElementById("motorPairMoveLeft");
        testMotorPairMoveLeft.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST ON motorPair.move(100, 'cm', -100, 100) #######");
            
            var motorPair = new mySPIKE.MotorPair("A", "B");

            motorPair.move(100, "cm", -100, 100);

            console.log("Expected result: driving base moving left and stopping")
            console.log("###### ENDING UNIT TEST ON motorPair.move(100, 'cm', -100, 100) #######");

        })

        var testMotorPairMoveRight = document.getElementById("motorPairMoveRight");
        testMotorPairMoveRight.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST ON motorPair.move(100, 'cm', 100, 100) #######");
            
            var motorPair = new mySPIKE.MotorPair("A", "B");
            
            motorPair.move(100, "cm", 100, 100);
            
            console.log("Expected result: driving base moving right and stopping")
            console.log("###### ENDING UNIT TEST ON motorPair.move(100, 'cm', 100, 100) #######");
        })


        var testMotorPairMoveLeftSlightly = document.getElementById("motorPairMoveLeftSlightly");
        testMotorPairMoveLeftSlightly.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST ON motorPair.move(100, 'cm', -50, 100) #######");

            var motorPair = new mySPIKE.MotorPair("A", "B");

            motorPair.move(100, "cm", -50, 100);

            console.log("Expected result: driving base moving left SLIGHTLY and stopping")
            console.log("###### ENDING UNIT TEST ON motorPair.move(100, 'cm', -50, 100) #######");

        })

        var testMotorPairMoveRightSlightly = document.getElementById("motorPairMoveRightSlightly");
        testMotorPairMoveRightSlightly.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST ON motorPair.move(100, 'cm', 50, 100) #######");

            var motorPair = new mySPIKE.MotorPair("A", "B");

            motorPair.move(100, "cm", 50, 100);

            console.log("Expected result: driving base moving right SLIGHTLY and stopping")
            console.log("###### ENDING UNIT TEST ON motorPair.move(100, 'cm', 50, 100) #######");
        })

        //                                      //
        //         Motion Sensor Tests          //
        //                                      //

        /* wait for new gesture */
        var testWaitForNewGesture = document.getElementById("waitForNewGesture");
        testWaitForNewGesture.addEventListener("click", async function () {
            console.log("###### BEGINNING UNIT TEST ON motionSensor.wait_for_new_gesture(callback) #######")
            console.log("Test: Program will detect either 'tapped' or 'doubletapped' gestures. Tap the hub display");

            
            hub.motion_sensor.wait_for_new_gesture( function(gesture) {

                console.log(">>> in callback")
                
                console.log(">>> gesture argument in callback, ", gesture);
                
                if (gesture == "tapped") {
                    console.log(">>> tapped event handler");
                    console.log("###### ENDING UNIT TEST ON motionSensor.wait_for_new_gesture(callback) #######")
                }
                else if ( gesture == "doubletapped" ) {
                    console.log(">>> doubletapped event handler");
                    console.log("###### ENDING UNIT TEST ON motionSensor.wait_for_new_gesture(callback) #######")
                }
                else {
                    console.log("###### ENDING UNIT TEST ON motionSensor.wait_for_new_gesture(callback) #######")
                }
            })
            
        })

        /* was gesture */
        var testWasGesture = document.getElementById("wasGesture");
        testWasGesture.addEventListener("click", async function () {
            
            console.log("###### BEGINNING UNIT TEST ON motion_sensor.was_gesture('doubletapped') #######")
            console.log("Test (First Time): Sees if 'doubletapped' gesture has occurred since the beginning of the program (for the first use).");
            console.log("Test (Second Time): Sees if 'doubletapped' gesture has occurred since the last execution of was_gesture().");
            
            if (hub.motion_sensor.was_gesture("doubletapped")) {
                console.log(">>> doubletapped did occur");
            } else {
                console.log(">>> doubletapped did NOT occur ");
            }

            console.log("###### ENDING UNIT TEST ON motion_sensor.was_gesture('doubletapped') #######")
        })

        /* wait for new orientation */
        var testWaitForNewOri = document.getElementById("waitForNewOri");
        testWaitForNewOri.addEventListener("click", async function () {
            console.log("###### BEGINNING UNIT TEST ON motion_sensor.wait_for_new_orientation(callback) #######")
            console.log("Test (First Time): the returned orientation will be the current orientation.");
            console.log("Test (Second Time): Sees if there's a new orientation different from the previously detected");

            console.log(">>> change the orientation of the hub");
            hub.motion_sensor.wait_for_new_orientation( function ( orientation ) {

                if ( orientation ) {
                    console.log(">>> the orientation is ", orientation);
                    console.log("###### ENDING UNIT TEST ON motionSensor.wait_for_new_orientation(callback)#######");
                }
            })
            
        })

        var testGetAngles = document.getElementById("getAngles");
        testGetAngles.addEventListener("click", async function () {
            console.log("###### BEGINNING UNIT TEST ON motion_sensor get_***_angle() functions #######");
            
            console.log("yaw angle: ", hub.motion_sensor.get_yaw_angle());
            console.log("pitch angle: ", hub.motion_sensor.get_pitch_angle());
            console.log("roll angle: ", hub.motion_sensor.get_roll_angle());
            console.log("###### ENDING UNIT TEST ON get_***_angle() functions #######");
        })

        var testGetGesture = document.getElementById("getGesture");
        testGetGesture.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST ON motion_sensor.get_gesture() #######");
            
            var gesture = hub.motion_sensor.get_gesture();
            console.log("gesture: ", gesture);
            
            console.log("###### ENDING UNIT TEST ON motion_sensor.get_gesture() #######");
        })

        var testGetOrientation = document.getElementById("getOrientation");
        testGetOrientation.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST ON motion_sensor.get_orientation() #######");


            var orientation = hub.motion_sensor.get_orientation();
            console.log("orientation: ", orientation);

            console.log("###### ENDING UNIT TEST ON motion_sensor.get_orientation() #######");
        })

        var testResetYaw = document.getElementById("resetYaw");
        testResetYaw.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST ON motion_sensor.reset_yaw_angle() #######");
            console.log("Test: reset yaw angle and get yaw angle after 3 seconds");
            

            hub.motion_sensor.reset_yaw_angle();

            setTimeout(function () {
                console.log(hub.motion_sensor.get_yaw_angle());
            }, 3000 );

            console.log("###### ENDING UNIT TEST ON motion_sensor.reset_yaw_angle() #######");
        })

        var testResetYawSource = document.getElementById("resetYawSource");
        testResetYawSource.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST (logic) ON motion_sensor.reset_yaw_angle() #######");
            /* randomly generate current position */
            // get the digits
            var currPos = Math.floor(Math.random() * 1000);
            while ( currPos > 180 ) {
                currPos = Math.floor(Math.random() * 1000)
            }

            // get the sign
            var negativeOrPositive = Math.random() * 1000;
            if (negativeOrPositive > 500) {
                var currPos = currPos * -1;
            }

            console.log("current position: ", currPos)

            /* randomly generate new origin */
            // get the digits
            var newOrigin = Math.floor(Math.random() * 1000);
            while (newOrigin > 180) {
                newOrigin = Math.floor(Math.random() * 1000);
            }

            // get the sign
            var negativeOrPositive = Math.random() * 1000;
            if (negativeOrPositive > 500) {
                var newOrigin = newOrigin * -1;
            }

            console.log("new origin", newOrigin);

            var difference = currPos - newOrigin;


            if ( -180 > difference && difference > -360 ) {
                var newPos = Math.abs(difference) % 180;
            }
            else if ( 180 < difference && difference < 360 ) {
                var newPos = (Math.abs(difference) % 180) * -1;
            }
            else {
                console.log("difference", difference);
                var newPos = difference % 360;
            }

            /*
            var tPos = (currPos - newOrigin) % 180;
            // newOrigin is higher than currPos
            if ((newOrigin - currPos) == 180) {
                var tPos = -180;
            }

            // newOrigin is lower than currPos
            else if ((newOrigin - currPos) == -180) {
                var tPos = 180;
            }

            // the new origin is below 0 
            if (newOrigin < 0) {
                var top = 180 + newOrigin; // the value above newOrigin at which yaw_angle is considered -180
                // tPos needs to be negative
                if (currPos > top || currPos < newOrigin) {
                    if (currPos > top) {
                        // (top margin + bottom margin) * -1
                        var tPos = ((180 - currPos) + (180 - newOrigin)) * -1;
                    }
                    // newOrigin < 0
                    // currPos < newOrigin
                    // Thus, currPos < 0
                    else {
                        var tPos = currPos - newOrigin;
                    }
                }
                // tPos needs to be positive
                else if (currPos < top && currPos > newOrigin) {
                    if (currPos < 0) {
                        var tPos = currPos - newOrigin;
                    }
                    else {
                        var tPos = currPos - newOrigin;
                    }
                }
                // tPos needs to be 0
                else {

                }
            }
            // the new origin is above 0
            else if (newOrigin > 0) {
                var bottom = -180 + newOrigin; // the value below newOrigin at which yaw_angle is considered 180
                
                // tPos needs to be negative
                if (currPos > bottom && currPos < newOrigin) {
                    // currPos > bottom ( so a modulo op is NOT needed )
                    // and currPos < newOrigin ( so tPos needs to be negative )

                    // currPos 
                    if (currPos < 0) {
                        var tPos = Math.abs(currPos - newOrigin) * -1;
                    }
                    else {
                        var tPos = currPos - newOrigin
                    }
                }
                // tPos needs to be positive
                else if (currPos < bottom || currPos > newOrigin) {
                    // currPos < 0 and newOrigin > 0 and currPos < bottom ( |currPos - newOrigin| >= 180 )
                    if (currPos < bottom) {
                        // ( bottom margin + top margin)
                        var tPos = ((180 + currPos) + (180 - newOrigin));
                    }
                    // currPos > 0 and newOrigin > 0 and currPos > newOrigin and |currPos - newOrigin| < 180
                    else {
                        var tPos = currPos - newOrigin;
                    }
                }
                // tPos needs to be 0
                else {

                }
            }
            // newOrigin is 0
            else {

            }
            */

            console.log("translated position: ", newPos);
        })

        //                                      //
        //        Force Sensor Tests            //
        //                                      //
        
        var testGetForceNewton = document.getElementById("getForceNewton");
        testGetForceNewton.addEventListener("click", async function() {
            console.log("###### BEGINNING UNIT TEST ON ForceSensor.get_force_newton() #######");
            console.log("Test: Execute this test while pressing on a Force Sensor connected at port A");
            var force_sensor = new mySPIKE.ForceSensor("A");
            var newtons = force_sensor.get_force_newton();
            console.log("Force in Newtons: ", newtons);
            console.log("Expected Result: [1 to 10] reading on force on sensor");
            console.log("###### ENDING UNIT TEST ON ForceSensor.get_force_newton() #######");
        })

        var testGetForcePercentage = document.getElementById("getForcePercentage");
        testGetForcePercentage.addEventListener("click", function() {
            console.log("###### BEGINNING UNIT TEST ON ForceSensor.get_force_percentage() #######");
            console.log("Test: Execute this test while pressing on a Force Sensor connected at port A");
            var force_sensor = new mySPIKE.ForceSensor("A");
            var percentage = force_sensor.get_force_percentage();
            console.log("Force in percentage: ", percentage);
            console.log("Expected Result: [0 to 100] reading of force on sensor");
            console.log("###### ENDING UNIT TEST ON ForceSensor.get_force_percentage() #######");
        })

        var testForceSensorIsPressed = document.getElementById("forceSensorIsPressed");
        testForceSensorIsPressed.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST ON ForceSensor.is_pressed() #######");
            console.log("Test: Execute this test while pressing on a Force Sensor connected at port A");
            var force_sensor = new mySPIKE.ForceSensor("A");
            var isPressed = force_sensor.is_pressed();
            console.log("is pressed? ", isPressed);
            console.log("Expected Result: get true when force sensor is pressed, false otherwise");
            console.log("###### ENDING UNIT TEST ON ForceSensor.is_pressed() #######");
        })

        var testForceSensorWaitUntilPress = document.getElementById("forceSensorWaitUntilPress");
        testForceSensorWaitUntilPress.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST ON ForceSensor.wait_until_pressed() #######");
            console.log("Test: Execute this test and then after some time press on a Force Sensor connected at port A");
            var force_sensor = new mySPIKE.ForceSensor("A");
            force_sensor.wait_until_pressed( function () {
                console.log("Force Sensor press event handler");
                console.log("###### ENDING UNIT TEST ON ForceSensor.wait_until_pressed() #######");
            })
            console.log("Expected Result: when pressed, console logs 'Force Sensor press event handler'");
        })

        var testForceSensorWaitUntilRelease = document.getElementById("forceSensorWaitUntilRelease");
        testForceSensorWaitUntilRelease.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST ON ForceSensor.wait_until_released() #######");
            console.log("Test: Execute this test and then after some time press on a Force Sensor connected at port A and then release it");
            var force_sensor = new mySPIKE.ForceSensor("A");
            force_sensor.wait_until_released( function() {
                console.log("Force Sensor release event handler");
                console.log("###### ENDING UNIT TEST ON ForceSensor.wait_until_released() #######");
            })
            console.log("Expected Result: when force sensor RELEASED, console logs 'Force Sensor release event handler'");
        })
        
        //                                      //
        //            Speaker Tests             //
        //                                      //

        
        var testBeep = document.getElementById("beep");
        testBeep.addEventListener("click", async function () {
            console.log("###### BEGINNING UNIT TEST ON Primehub.speaker.beep(100,3) #######")
            console.log("Test: Hub will beep for 3 seconds")
            var hub = mySPIKE.PrimeHub();
            var speaker = hub.speaker;
            console.log("speaker object", speaker);
            speaker.beep(100, 3);
            console.log("###### ENDING UNIT TEST ON Primehub.speaker.beep(100,3)#######")
        })
        
        var testStartBeep = document.getElementById("startBeep");
        testStartBeep.addEventListener("click", async function () {
            console.log("###### BEGINNING UNIT TEST ON Primehub.speaker.start_beep(100) #######")
            console.log("Test: Hub will beep unless stopped (use speaker.stop())");
            var hub = mySPIKE.PrimeHub();
            var speaker = hub.speaker;
            speaker.start_beep(100);
            console.log("###### ENDING UNIT TEST ON Primehub.speaker.start_beep(100)#######")
        })

        var testStopBeep = document.getElementById("stopBeep");
        testStopBeep.addEventListener("click", async function () {
            console.log("###### BEGINNING UNIT TEST ON Primehub.speaker.stop() #######")
            console.log("hub beeping will stop");
            var hub = mySPIKE.PrimeHub();
            var speaker = hub.speaker;
            speaker.stop();
            console.log("###### ENDING UNIT TEST ON Primehub.speaker.stop() #######")
        })

        //                                      //
        //              Button Tests            //
        //                                      //

        
        var testButtonIsPressed = document.getElementById("buttonIsPress");
        testButtonIsPressed.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST ON button.is_pressed() #######");
            console.log("Test: start the test pressing either the left button or the right button");
            
            
            var left_button = hub.left_button;
            var right_button = hub.right_button;
            
            if (left_button.is_pressed()) {
                console.log("left_button is pressed");
            }
            
            if (right_button.is_pressed()) {
                console.log("right_button is pressed");
            }
            console.log("Expected result: the console logs whether the button is pressed");
            console.log("###### ENDING UNIT TEST ON button.is_pressed() #######");
        })
        
        var testButtonWasPressed = document.getElementById("buttonWasPress");
        testButtonWasPressed.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST ON button.was_pressed() #######");
            console.log("Test: press either the left button or the right button. Then, after some time start the test.");
            
            
            var left_button = hub.left_button;
            var right_button = hub.right_button;
            
            if (left_button.was_pressed()) {
                console.log("left_button was pressed");
            }
            
            if (right_button.was_pressed()) {
                console.log("right_button was pressed");
            }
            console.log("Expected result: console identifies previous button presses")
            console.log("###### ENDING UNIT TEST ON button.was_pressed() #######");
        })

        var testButtonWaitPressed = document.getElementById("buttonWaitPress");
        testButtonWaitPressed.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST ON button.wait_until_pressed() #######");
            console.log("Test: Start the test. Then, after some time press either left button or right button");
            

            var left_button = hub.left_button;
            var right_button = hub.right_button;

            console.log("waiting for left_button press")
            left_button.wait_until_pressed( function () {
                console.log("left_button was pressed");
                console.log("###### ENDING UNIT TEST ON button.wait_until_pressed() #######");
            })

            console.log("waiting for right_button press")
            right_button.wait_until_pressed( function () {
                console.log("right_button was pressed");
                console.log("###### ENDING UNIT TEST ON button.wait_until_pressed() #######");
            })

            console.log("Expected result: console identifies button presses")
        })
        
        
        var testButtonWaitRelease = document.getElementById("buttonWaitRelease");
        testButtonWaitRelease.addEventListener("click", function () {
            console.log("###### BEGINNING UNIT TEST ON button.wait_until_released() #######");
            console.log("Test: Start the test. Then, after some time press either left button or right button and release them");
            

            var left_button = hub.left_button;
            var right_button = hub.right_button;

            console.log("waiting for left_button release")
            left_button.wait_until_released(function () {
                console.log("left_button was released");
                console.log("###### ENDING UNIT TEST ON button.wait_until_released() #######");
            })

            console.log("waiting for right_button release")
            right_button.wait_until_released(function () {
                console.log("right_button was released");
                console.log("###### ENDING UNIT TEST ON button.wait_until_released() #######");
            })

            console.log("Expected result: console identifies button releases")
        })

        //                                      //
        //               Misc Tests             //
        //                                      //

        var testSetHubOrientation = document.getElementById("setHubOri");
        testSetHubOrientation.addEventListener("click", async function () {
            console.log("###### BEGINNING UNIT TEST ON setHubOrientation() #######");
            console.log("Test: Move the hub to an orientation and press the test button to see if the measured orientation is correct");
            mySPIKE.setHubOrientation();
            console.log("###### ENDING UNIT TEST ON setHubOrientation() #######");
        })

        var testUJSONRPC = document.getElementById("testUJSONRPC");
        testUJSONRPC.addEventListener("click", async function () {
            console.log("###### BEGINNING UNIT TEST ON UJSONRPC.displayText #######");
            console.log("Expected Result: 'hello' on hub display");
            mySPIKE.UJSONRPC.displayText("hello");
            console.log("###### ENDING UNIT TEST ON UJSONRPC.displayText #######");
        })

        var testNew = document.getElementById("testNewKeyword");
        testNew.addEventListener("click", async function () {
            console.log("###### BEGINNING UNIT TEST ON new keywords with Motor connected to port A #######");
            console.log("Test: see the difference of using 'new' keyword on SPIKE device object instantiations");
            console.log("motor1 = mySPIKE.Motor('A')")
            console.log("motor2 = new mySPIKE.Motor('A')")
            console.log("motor1's default speed changed to 50")
            var motor1 = mySPIKE.Motor("A");
            motor1.set_default_speed(50);

            var motor1_defaultSpeed = motor1.get_default_speed();

            console.log("motor1's default_speed, ", motor1_defaultSpeed);
            
            var motor2 = new mySPIKE.Motor("A");
            var motor2_defaultSpeed = motor2.get_default_speed();
            console.log("motor2's default_speed, ", motor2_defaultSpeed);

            console.log("###### ENDING UNIT TEST ON new keywords with Motor connected to port A #######");
        });

        var testNew1 = document.getElementById("testNewKeyword1");
        testNew1.addEventListener("click", async function () {
            console.log("###### BEGINNING UNIT TEST ON two Motor objects declared without 'new' keywords #######");
            console.log("Test: see if Motor objects defined without 'new' keywords cause issues");
            console.log("motor1 = mySPIKE.Motor('A')")
            console.log("motor2 = mySPIKE.Motor('B')")
            console.log("motor1's default speed changed to 50")
            var motor1 = mySPIKE.Motor("A");
            motor1.set_default_speed(50);
            var motor1_defaultSpeed = motor1.get_default_speed();
            console.log("motor1's default_speed, ", motor1_defaultSpeed);
            var motor2 = mySPIKE.Motor("B");
            var motor2_defaultSpeed = motor2.get_default_speed();
            console.log("motor2's default_speed, ", motor2_defaultSpeed);
            console.log("###### ENDING UNIT TEST ON two Motor objects declared without 'new' keywords #######");
        });
        
        /* test mySPIKE.getMotorPorts() */
        var test_getMotorPorts = document.getElementById("getMotorPorts");
        test_getMotorPorts.addEventListener("click", async function () {
            var motorPorts = await mySPIKE.getMotorPorts();
            console.log(motorPorts);
        })

        //////////////////////////////////////////
        //                                      //
        //           SystemLink Testing         //
        //                                      //
        //////////////////////////////////////////

        /* test getTagsInfo */
        var getTagsInfo = document.getElementById("getTagsInfo");
        getTagsInfo.addEventListener("click", async function () {
            var tagsInfo = await mySL.getTagsInfo();
            console.log(tagsInfo);
        })

        /* test createNewTag */
        var createNewTag = document.getElementById("createNewTag");
        createNewTag.addEventListener("click", async function () {
            mySL.createTag("newTag", 4, async function () {
                var tagsInfo = await mySL.getTagsInfo();
                console.log(tagsInfo);
            });
        })

        /* test deleteTag */

        // create "newTag" and delete it
        var deleteTag = document.getElementById("deleteTag");
        deleteTag.addEventListener("click", async function () {
            console.log("creating 'newTag' with value 4 "); 
            
            // create 'newTag'
            mySL.createTag("newTag", 4, async function () {

                console.log("'newTag' was created");
                
                await sleep(1000);

                console.log(await mySL.getTagsInfo());
                //delete 'newTag'

                mySL.deleteTag("newTag", async function () {

                    console.log("'newTag' has been deleted")
                    console.log(await mySL.getTagsInfo());

                });
            });
        });

        // delete "newTag" once if it doesnt exist, twice if it does
        var deleteTag1 = document.getElementById("deleteTag1");
        deleteTag1.addEventListener("click", async function () {
            console.log("checking if 'newTag' exists");
            
            var tagsInfo = await mySL.getTagsInfo();
            var newTagExists = false;

            for ( key in tagsInfo ) {
                if ( key == "newTag" ) {
                    newTagExists = true;
                }
            }

            if ( newTagExists ) {

                console.log("newTag exists, deleting it twice")

                mySL.deleteTag("newTag", async function() {
                    console.log("newTag deleted");

                    await sleep(2000);

                    tagsInfo = await mySL.getTagsInfo();

                    console.log(tagsInfo);

                    mySL.deleteTag("newTag", async function() 
                    {
                        console.log("newTag deleted again");

                        await sleep(2000);

                        tagsInfo = await mySL.getTagsInfo();

                        console.log(tagsInfo);
                    })
                })
            } else {
                console.log("newTag doesn't exist, deleting it");
                mySL.deleteTag("newTag", async function () {
                    console.log("newTag deleted");

                    await sleep(2000);

                    tagsInfo = await mySL.getTagsInfo();

                    console.log(tagsInfo);
                })
            }
        });


        // just delete
        var deleteTag2 = document.getElementById("deleteTag2");
        deleteTag2.addEventListener("click", async function () {
            mySL.deleteTag("newTag", async function () {
                console.log("newTag deleted");

                await sleep(2000);

                tagsInfo = await mySL.getTagsInfo();

                console.log(tagsInfo);
            })
        });

        /* TEST setTagValue CASES*/

        var setTagValue = document.getElementById("setTagValue");
        setTagValue.addEventListener("click", async function () {
            console.log("creating 'newTag' with value 4 ");
            
            // create 'newTag'
            mySL.createTag("newTag", 4, async function () {
                
                console.log("'newTag' was created")
                
                await sleep(2000);

                console.log(await mySL.getTagsInfo());
                
                //set tag value to 5
                mySL.setTagValue("newTag", 5);
                console.log("'newTag' value was changed to 5. run tagsinfo to check");
            });
        })

        window.addEventListener("load", function () {

            test_getMotorPorts.style.backgroundColor = "lightgreen";
            testBeep.style.backgroundColor = "lightgreen";
            testStartBeep.style.backgroundColor = "lightgreen";
            testStopBeep.style.backgroundColor = "lightgreen";
            testMotorRelPos.style.backgroundColor = "lightgreen";
            testMotorRelPos1.style.backgroundColor = "lightgreen";
            testWasGesture.style.backgroundColor = "lightgreen";
            testWaitForNewGesture.style.backgroundColor = "lightgreen";
            testWaitForNewOri.style.backgroundColor = "lightgreen";
            testSetHubOrientation.style.backgroundColor = "lightgreen";
            testForceSensorIsPressed.style.backgroundColor = "lightgreen";
            testForceSensorWaitUntilPress.style.backgroundColor = "lightgreen";
            testForceSensorWaitUntilRelease.style.backgroundColor = "lightgreen";
            testGetForceNewton.style.backgroundColor = "lightgreen";
            testGetForcePercentage.style.backgroundColor = "lightgreen";
            testGetAngles.style.backgroundColor = "lightgreen";
            testUJSONRPC.style.backgroundColor = "lightgreen";
            testGetGesture.style.backgroundColor = "lightgreen";
            testGetOrientation.style.backgroundColor = "lightgreen";
            testButtonIsPressed.style.backgroundColor = "lightgreen";
            testButtonWaitPressed.style.backgroundColor = "lightgreen";
            testButtonWaitRelease.style.backgroundColor = "lightgreen";
            testButtonWasPressed.style.backgroundColor = "lightgreen";
            testResetYaw.style.backgroundColor = "red";
            testMotorPairStop.style.backgroundColor = "lightgreen";
            testMotorPairMove.style.backgroundColor = "red";
            //testMotorPairStart
            testMotorPairMoveLeft.style.backgroundColor = "red";
            testMotorPairMoveRight.style.backgroundColor = "red";
            testMotorPairMoveLeftSlightly.style.backgroundColor = "red";
            testMotorPairMoveRightSlightly.style.backgroundColor = "red";

            getTagsInfo.style.backgroundColor = "lightgreen";
            createNewTag.style.backgroundColor = "lightgreen";
            setTagValue.style.backgroundColor = "lightgreen";

            SLTestDecisionHandler();
            SPIKETestDecisionHandler();

            var selectTest = document.getElementById("SL_test_select");
            
            selectTest.addEventListener("click", function () {
                SLTestDecisionHandler();
            })


            var SPIKEselectTest = document.getElementById("SPIKE_test_select");

            SPIKEselectTest.addEventListener("click", function () {
                SPIKETestDecisionHandler();
            })
        })

        function SLTestDecisionHandler() {
                            var testFunction = $("#SLselectTest option:selected").attr('id');

            if (testFunction == "getTagsInfoOPTION") {
                var testCases = document.getElementsByClassName("SLtestCase");
                for (var index = 0; index < testCases.length; index++) {
                    testCases[index].style.display = "none";
                }

                var selectedCases = document.getElementsByClassName("getTagsInfo");
                for (var index = 0; index < selectedCases.length; index++) {
                    var aCase = selectedCases[index];
                    aCase.style.display = "block";
                }
            }
            else if (testFunction == "deleteTagOPTION") {
                var testCases = document.getElementsByClassName("SLtestCase");
                for (var index = 0; index < testCases.length; index++) {
                    testCases[index].style.display = "none";
                }

                var selectedCases = document.getElementsByClassName("deleteTag");
                for (var index = 0; index < selectedCases.length; index++) {
                    var aCase = selectedCases[index];
                    aCase.style.display = "block";
                }
            }
            else if (testFunction == "createNewTagOPTION") {
                var testCases = document.getElementsByClassName("SLtestCase");
                for (var index = 0; index < testCases.length; index++) {
                    testCases[index].style.display = "none";
                }

                var selectedCases = document.getElementsByClassName("createNewTag");
                for (var index = 0; index < selectedCases.length; index++) {
                    var aCase = selectedCases[index];
                    aCase.style.display = "block";
                }
            }
            else if (testFunction == "setTagValueOPTION") {
                var testCases = document.getElementsByClassName("SLtestCase");
                for (var index = 0; index < testCases.length; index++) {
                    testCases[index].style.display = "none";
                }

                var selectedCases = document.getElementsByClassName("setTagValue");
                for (var index = 0; index < selectedCases.length; index++) {
                    var aCase = selectedCases[index];
                    aCase.style.display = "block";
                }
            }
        }

        function SPIKETestDecisionHandler() {
                            var testCases = undefined;
            var testFunction = $("#SPIKEselectTest option:selected").attr('id');

            if (testFunction == "motorOPTION") {
                var testCases = document.getElementsByClassName("SPIKEtestCase");
                for (var index = 0; index < testCases.length; index++) {
                    testCases[index].style.display = "none";
                }

                var selectedCases = document.getElementsByClassName("motor");
                for (var index = 0; index < selectedCases.length; index++) {
                    var aCase = selectedCases[index];
                    aCase.style.display = "block";
                }
            }
            else if (testFunction == "motionOPTION") {
                var testCases = document.getElementsByClassName("SPIKEtestCase");
                for (var index = 0; index < testCases.length; index++) {
                    testCases[index].style.display = "none";
                }

                var selectedCases = document.getElementsByClassName("motion");
                for (var index = 0; index < selectedCases.length; index++) {
                    var aCase = selectedCases[index];
                    aCase.style.display = "block";
                }
            }
            else if (testFunction == "speakerOPTION") {
                var testCases = document.getElementsByClassName("SPIKEtestCase");
                for (var index = 0; index < testCases.length; index++) {
                    testCases[index].style.display = "none";
                }

                var selectedCases = document.getElementsByClassName("speaker");
                for (var index = 0; index < selectedCases.length; index++) {
                    var aCase = selectedCases[index];
                    aCase.style.display = "block";
                }
            }
            else if (testFunction == "miscOPTION") {
                var testCases = document.getElementsByClassName("SPIKEtestCase");
                for (var index = 0; index < testCases.length; index++) {
                    testCases[index].style.display = "none";
                }

                var selectedCases = document.getElementsByClassName("misc");
                for (var index = 0; index < selectedCases.length; index++) {
                    var aCase = selectedCases[index];
                    aCase.style.display = "block";
                }
            }
            else if (testFunction == "buttonOPTION") {
                var testCases = document.getElementsByClassName("SPIKEtestCase");
                for (var index = 0; index < testCases.length; index++) {
                    testCases[index].style.display = "none";
                }

                var selectedCases = document.getElementsByClassName("button");
                for (var index = 0; index < selectedCases.length; index++) {
                    var aCase = selectedCases[index];
                    aCase.style.display = "block";
                }
            }
            else if (testFunction == "forceOPTION") {
                var testCases = document.getElementsByClassName("SPIKEtestCase");
                for (var index = 0; index < testCases.length; index++) {
                    testCases[index].style.display = "none";
                }

                var selectedCases = document.getElementsByClassName("force");
                for (var index = 0; index < selectedCases.length; index++) {
                    var aCase = selectedCases[index];
                    aCase.style.display = "block";
                }
            }
            else if (testFunction == "motorPairOPTION") {
                var testCases = document.getElementsByClassName("SPIKEtestCase");
                for (var index = 0; index < testCases.length; index++) {
                    testCases[index].style.display = "none";
                }

                var selectedCases = document.getElementsByClassName("motorPair");
                for (var index = 0; index < selectedCases.length; index++) {
                    var aCase = selectedCases[index];
                    aCase.style.display = "block";
                }
            }

        }

        //sleep function
            function sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
    </script>
    <style>
        #SPIKEbox {
            position: absolute;
            top: 200px;
            left: 50px;
            height: 400px;
            width: 400px;
            background-color: #4CE0D2;
            border: solid;
        }

        #SLbox {
            position: absolute;
            top: 200px;
            left: 500px;
            height: 400px;
            width: 400px;
            background-color: #4CE0D2;
            border: solid;
        }

        .testCase {
            display:none;
            display:flex;
            flex-direction: column;
        }

        #SPIKE_test_select, #SL_test_select {
            background-color: rgb(247, 250, 48);
        }
    </style>
</html>